<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Hello-Backbone.js</title>
</head>
<body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
    <script src="http://ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js"></script>
    <script src="http://ajax.cdnjs.com/ajax/libs/underscore.js/1.1.6/underscore-min.js"></script>
    <script src="http://ajax.cdnjs.com/ajax/libs/backbone.js/0.3.3/backbone-min.js"></script>
    <script>

    (function($) {
        var Item = Backbone.Model.extend({
            defaults: {
                part1: 'Hello',
                part2: 'World'
            },
        });

        var List = Backbone.Collection.extend({
            model: Item
        });

        var ListView = Backbone.View.extend({
            el: $('body'),                  //attaches this.el to an exsiting element

            events: {
                'click button#add': 'addItem',  //call 'addItem' on click 'add'(id) button 
            },

            initialize: function() {
                _.bindAll(this, 'render', 'addItem', 'appendItem');  // every function that uses 'this' as the current object should be in this list

                this.collection = new List();
                this.collection.bind('add',this.appendItem);

                this.render();
                this.counter=0;
            },

            render: function() {
                var self = this;

                $(this.el).append('<button id="add">Add List Item</button>');
                $(this.el).append('<ul></ul>');

                _(this.collection.models).each(function(item) {
                    self.appendItem(item);
                },this);
            },

            addItem: function() {
                this.counter++;
                var item = new Item();
                item.set({
                    part2: item.get('part2') + this.counter
                });

                this.collection.add(item);
            },

            appendItem: function(item) {
                $('ul',this.el).append("<li>"+item.get('part1')+" "+item.get('part2')+"</li>");
            }
        });

        var listView = new ListView();
    })(jQuery);

    </script>
</body>
</html>